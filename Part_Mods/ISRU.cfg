// Add Karbonite to the ISRU if installed.
@PART[KKAOSS_ISRU_g]:NEEDS[Karbonite]
{
    MODULE
    {
         name = ModuleResourceConverter_USI
         ConverterName = LiquidFuel (Karbonite)
         StartActionName = Start LiquidFuel
         StopActionName = Stop LiquidFuel

        UseSpecialistBonus = true
		SpecialistEfficiencyFactor = 0.2
		SpecialistBonusBase = 0.05
		ExperienceEffect = ConverterSkill
		Efficiency = 1
         INPUT_RESOURCE
         {
            ResourceName = ElectricCharge
            Ratio = 6
         }
         INPUT_RESOURCE
         {
            ResourceName = Karbonite
            Ratio = 4.5
         }
         OUTPUT_RESOURCE
         {
            ResourceName = LiquidFuel
            Ratio = 0.9
            DumpExcess = false
         }

    }
    MODULE
    {
        name = ModuleResourceConverter_USI
        ConverterName = Oxidizer (Karbonite)
        StartActionName = Start Oxidizer
        StopActionName = Stop Oxidizer

        UseSpecialistBonus = true
		SpecialistEfficiencyFactor = 0.2
		SpecialistBonusBase = 0.05
		ExperienceEffect = ConverterSkill
		Efficiency = 1
         INPUT_RESOURCE
         {
            ResourceName = ElectricCharge
            Ratio = 6
         }
         INPUT_RESOURCE
         {
            ResourceName = Karbonite
            Ratio = 5.5
         }
         OUTPUT_RESOURCE
         {
            ResourceName = Oxidizer
            Ratio = 1.1
            DumpExcess = false
         }
    }

    MODULE
    {
         name = ModuleResourceConverter_USI
         ConverterName = LFO Mix (Karbonite)
         StartActionName = Start LFO
         StopActionName = Stop LFO

        UseSpecialistBonus = true
		SpecialistEfficiencyFactor = 0.2
		SpecialistBonusBase = 0.05
		ExperienceEffect = ConverterSkill
		Efficiency = 1
         INPUT_RESOURCE
         {
            ResourceName = ElectricCharge
            Ratio = 12
         }
         INPUT_RESOURCE
         {
            ResourceName = Karbonite
            Ratio = 10
         }
         OUTPUT_RESOURCE
         {
            ResourceName = Oxidizer
            Ratio = 1.1
            DumpExcess = false
         }
         OUTPUT_RESOURCE
         {
            ResourceName = LiquidFuel
            Ratio = 0.9
            DumpExcess = false
         }
    }

    MODULE
    {
         name = ModuleResourceConverter_USI
         ConverterName = H2O Condenser (Karbonite)
         StartActionName = Start H2O
         StopActionName = Stop H2O

        UseSpecialistBonus = true
		SpecialistEfficiencyFactor = 0.2
		SpecialistBonusBase = 0.05
		ExperienceEffect = ConverterSkill
		Efficiency = 1
         INPUT_RESOURCE
         {
            ResourceName = Karbonite
            Ratio = 5
         }
         INPUT_RESOURCE
         {
            ResourceName = ElectricCharge
            Ratio = 6
         }
         OUTPUT_RESOURCE
         {
            ResourceName = Water
            Ratio = 1
            DumpExcess = False
         }
    }

    MODULE
    {
         name = ModuleResourceConverter_USI
         ConverterName = LH2/Ox (Karbonite)
         StartActionName = Start LH2/Ox
         StopActionName = Stop LH2/Ox

        UseSpecialistBonus = true
		SpecialistEfficiencyFactor = 0.2
		SpecialistBonusBase = 0.05
		ExperienceEffect = ConverterSkill
		Efficiency = 1
         INPUT_RESOURCE
         {
            ResourceName = Karbonite
            Ratio = 5
         }
         INPUT_RESOURCE
         {
            ResourceName = ElectricCharge
            Ratio = 6
         }
         OUTPUT_RESOURCE
         {
            ResourceName = LqdHydrogen
            Ratio = 1.25
            DumpExcess = False
         }
         OUTPUT_RESOURCE
         {
            ResourceName = Oxygen
            Ratio = 355
            DumpExcess = true
         }

    }

    MODULE
    {
         name = ModuleResourceConverter_USI
         ConverterName = Ox/LH2 (Karbonite)
         StartActionName = Start Ox/LH2
         StopActionName = Stop Ox/LH2

        UseSpecialistBonus = true
		SpecialistEfficiencyFactor = 0.2
		SpecialistBonusBase = 0.05
		ExperienceEffect = ConverterSkill
		Efficiency = 1
         INPUT_RESOURCE
         {
            ResourceName = Karbonite
            Ratio = 5
         }
         INPUT_RESOURCE
         {
            ResourceName = ElectricCharge
            Ratio = 6
         }
         OUTPUT_RESOURCE
         {
            ResourceName = LqdHydrogen
            Ratio = 1.25
            DumpExcess = true
         }
         OUTPUT_RESOURCE
         {
            ResourceName = Oxygen
            Ratio = 355
            DumpExcess = false
         }
    }

    MODULE
    {
         name = ModuleResourceConverter_USI
         ConverterName = MonoPropellant (Karbonite)
         StartActionName = Start MonoPropellant
         StopActionName = Stop MonoPropellant

        UseSpecialistBonus = true
		SpecialistEfficiencyFactor = 0.2
		SpecialistBonusBase = 0.05
		ExperienceEffect = ConverterSkill
		Efficiency = 1
         INPUT_RESOURCE
         {
            ResourceName = Karbonite
            Ratio = 5
         }
         INPUT_RESOURCE
         {
            ResourceName = ElectricCharge
            Ratio = 6
         }
         OUTPUT_RESOURCE
         {
            ResourceName = MonoPropellant
            Ratio = 1
            DumpExcess = False
         }
    }
}


// Two converters: One for fuel, and one for the refinary toolchain.
// This is the refinery.
+PART[KKAOSS_ISRU_g]:NEEDS[KolonyTools]
{
    @name = KKAOSS_MKSAddon_ISRU
    @title = K&K Extraction Refinery

    @description = Seeing a need for the ability to refine more things that just fuel, K&K did a quick, erm, came up with a *totally* new materials processing refineary!

    !MODULE[ModuleResourceConverter] { }

	MODULE
	{
		name = ModuleSwappableConverter
		bayName = B1
		typeName = Config
		ResourceCosts = SpecializedParts,22,MaterialKits,110,ElectricCharge,110
	}
	MODULE
	{
		name = ModuleSwappableConverter
		bayName = B2
		typeName = Config
		ResourceCosts = SpecializedParts,22,MaterialKits,110,ElectricCharge,110
	}
	MODULE
	{
		name = ModuleSwappableConverter
		bayName = B3
		typeName = Config
		ResourceCosts = SpecializedParts,22,MaterialKits,110,ElectricCharge,110
	}
	RESOURCE
	{
		name = Machinery
		amount = 100
		maxAmount = 2000
	}
	RESOURCE
	{
		name = Recyclables
		amount = 0
		maxAmount = 2000
	}
	MODULE
	{
		name = USI_ModuleFieldRepair
	}

    	MODULE
	{
		name = ModuleResourceConverter_USI
		ConverterName = Metals
		StartActionName = Start Metals
		StopActionName = Stop Metals

		UseSpecialistBonus = true
		SpecialistEfficiencyFactor = 0.2
		SpecialistBonusBase = 0.05
		ExperienceEffect = ConverterSkill
		Efficiency = 1

		INPUT_RESOURCE
		{
			ResourceName = MetallicOre
			Ratio =  0.03050000
		}
		INPUT_RESOURCE
		{
			ResourceName = ElectricCharge
			Ratio = 31.72
		}
		OUTPUT_RESOURCE
		{
			ResourceName = Metals
			Ratio = 0.0061
			DumpExcess = False
		}
		INPUT_RESOURCE
		{
			ResourceName = Machinery
			Ratio = 0.0000400
		}
		OUTPUT_RESOURCE
		{
			ResourceName = Recyclables
			Ratio = 0.0000400
			DumpExcess = true
		}
		REQUIRED_RESOURCE
		{
			ResourceName = Machinery
			Ratio = 2000
		}
	}
	MODULE
	{
		name = ModuleResourceConverter_USI
		ConverterName = Chemicals
		StartActionName = Start Chemicals
		StopActionName = Stop Chemicals

		UseSpecialistBonus = true
		SpecialistEfficiencyFactor = 0.2
		SpecialistBonusBase = 0.05
		ExperienceEffect = ConverterSkill
		Efficiency = 1

		INPUT_RESOURCE
		{
			ResourceName = Minerals
			Ratio =  0.03050000
		}
		INPUT_RESOURCE
		{
			ResourceName = ElectricCharge
			Ratio = 31.72
		}
		OUTPUT_RESOURCE
		{
			ResourceName = Chemicals
			Ratio = 0.0061
			DumpExcess = False
		}
		INPUT_RESOURCE
		{
			ResourceName = Machinery
			Ratio = 0.0000400
		}
		OUTPUT_RESOURCE
		{
			ResourceName = Recyclables
			Ratio = 0.0000400
			DumpExcess = true
		}
		REQUIRED_RESOURCE
		{
			ResourceName = Machinery
			Ratio = 2000
		}
	}
	MODULE
	{
		name = ModuleResourceConverter_USI
		ConverterName = Silicon
		StartActionName = Silicon
		StopActionName = Silicon

		UseSpecialistBonus = true
		SpecialistEfficiencyFactor = 0.2
		SpecialistBonusBase = 0.05
		ExperienceEffect = ConverterSkill
		Efficiency = 1

		INPUT_RESOURCE
		{
			ResourceName = Silicates
			Ratio =  0.03050000
		}
		INPUT_RESOURCE
		{
			ResourceName = ElectricCharge
			Ratio = 31.72
		}
		OUTPUT_RESOURCE
		{
			ResourceName = Silicon
			Ratio = 0.0061
			DumpExcess = False
		}
		INPUT_RESOURCE
		{
			ResourceName = Machinery
			Ratio = 0.0000400
		}
		OUTPUT_RESOURCE
		{
			ResourceName = Recyclables
			Ratio = 0.0000400
			DumpExcess = true
		}
		REQUIRED_RESOURCE
		{
			ResourceName = Machinery
			Ratio = 2000
		}
	}
	MODULE
	{
		name = ModuleResourceConverter_USI
		ConverterName = Refined Exotics
		StartActionName = Start Refined Exotics
		StopActionName = Stop Refined Exotics

		UseSpecialistBonus = true
		SpecialistEfficiencyFactor = 0.2
		SpecialistBonusBase = 0.05
		ExperienceEffect = ConverterSkill
		Efficiency = 1

		INPUT_RESOURCE
		{
			ResourceName = RareMetals
			Ratio =  0.00458000
		}
		INPUT_RESOURCE
		{
			ResourceName = ExoticMinerals
			Ratio =  0.00458000
		}
		INPUT_RESOURCE
		{
			ResourceName = Chemicals
			Ratio =  0.01374000
		}
		INPUT_RESOURCE
		{
			ResourceName = ElectricCharge
			Ratio = 27.48
		}
		OUTPUT_RESOURCE
		{
			ResourceName = RefinedExotics
			Ratio = 0.00458000
			DumpExcess = False
		}
		INPUT_RESOURCE
		{
			ResourceName = Machinery
			Ratio = 0.0000400
		}
		OUTPUT_RESOURCE
		{
			ResourceName = Recyclables
			Ratio = 0.0000400
			DumpExcess = true
		}
		REQUIRED_RESOURCE
		{
			ResourceName = Machinery
			Ratio = 2000
		}
	}

		MODULE
	{
		name = ModuleBulkConverter
		ConverterName = Sifter
		StartActionName = Start Sifter
		StopActionName = Stop Sifter
		MinAbundance = 0.0
		Yield = 0.02375

		UseSpecialistBonus = true
		SpecialistEfficiencyFactor = 0.2
		SpecialistBonusBase = 0.05
		ExperienceEffect = GeologySkill
		Efficiency = 1

		INPUT_RESOURCE
		{
			ResourceName = Dirt
			Ratio = 0.095
		}
		INPUT_RESOURCE
		{
			ResourceName = ElectricCharge
			Ratio = 96.90
		}
		INPUT_RESOURCE
		{
			ResourceName = Machinery
			Ratio = 0.0000400
		}
		OUTPUT_RESOURCE
		{
			ResourceName = Recyclables
			Ratio = 0.0000400
			DumpExcess = true
		}
		REQUIRED_RESOURCE
		{
			ResourceName = Machinery
			Ratio = 2000
		}
	}

	MODULE
	{
		name = ModuleBulkConverter
		ConverterName = Lode Harvester
		StartActionName = Start Lode Harvester
		StopActionName = Stop Lode Harvester
		MinAbundance = 0.0
		Yield = 9.5

		UseSpecialistBonus = true
		SpecialistEfficiencyFactor = 0.2
		SpecialistBonusBase = 0.05
		ExperienceEffect = GeologySkill
		Efficiency = 1

		INPUT_RESOURCE
		{
			ResourceName = ResourceLode
			Ratio = 9.5
		}
		INPUT_RESOURCE
		{
			ResourceName = ElectricCharge
			Ratio = 96.90
		}
		INPUT_RESOURCE
		{
			ResourceName = Machinery
			Ratio = 0.0000400
		}
		OUTPUT_RESOURCE
		{
			ResourceName = Recyclables
			Ratio = 0.0000400
			DumpExcess = true
		}
		REQUIRED_RESOURCE
		{
			ResourceName = Machinery
			Ratio = 2000
		}
	}

		MODULE
	{
		name = ModuleResourceConverter_USI
		ConverterName = Fertilizer(G)
		StartActionName = Start Fertilizer(G)
		StopActionName = Stop Fertilizer(G)

		UseSpecialistBonus = true
		SpecialistEfficiencyFactor = 0.2
		SpecialistBonusBase = 0.05
		ExperienceEffect = ConverterSkill
		Efficiency = 1

		INPUT_RESOURCE
		{
			ResourceName = Gypsum
			Ratio =  0.0272
		}
		INPUT_RESOURCE
		{
			ResourceName = ElectricCharge
			Ratio = 29.92
		}
		OUTPUT_RESOURCE
		{
			ResourceName = Fertilizer
			Ratio = 0.0136
			DumpExcess = False
		}
		INPUT_RESOURCE
		{
			ResourceName = Machinery
			Ratio = 0.00004
		}
		OUTPUT_RESOURCE
		{
			ResourceName = Recyclables
			Ratio = 0.00004
			DumpExcess = true
		}
		REQUIRED_RESOURCE
		{
			ResourceName = Machinery
			Ratio = 2000
		}
	}

	MODULE
	{
		name = ModuleResourceConverter_USI
		ConverterName = Fertilizer(M)
		StartActionName = Start Fertilizer(M)
		StopActionName = Stop Fertilizer(M)

		UseSpecialistBonus = true
		SpecialistEfficiencyFactor = 0.2
		SpecialistBonusBase = 0.05
		ExperienceEffect = ConverterSkill
		Efficiency = 1

		INPUT_RESOURCE
		{
			ResourceName = Minerals
			Ratio =  0.03050000
		}
		INPUT_RESOURCE
		{
			ResourceName = ElectricCharge
			Ratio = 31.72
		}
		OUTPUT_RESOURCE
		{
			ResourceName = Fertilizer
			Ratio = 0.0061
			DumpExcess = False
		}
		INPUT_RESOURCE
		{
			ResourceName = Machinery
			Ratio = 0.0000400
		}
		OUTPUT_RESOURCE
		{
			ResourceName = Recyclables
			Ratio = 0.0000400
			DumpExcess = true
		}
		REQUIRED_RESOURCE
		{
			ResourceName = Machinery
			Ratio = 2000
		}
	}
}